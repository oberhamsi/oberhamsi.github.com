<!DOCTYPE html>
<head>
<title>VirtueJs</title>

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,600&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,700' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="http://localhost/virtuejs//static/main.css" />
<link rel="stylesheet" href="http://localhost/virtuejs//static/sh_hns.css" />
<link rel="stylesheet" href="http://localhost/virtuejs//static/tutorial.css" />
<script type="text/javascript" src="http://localhost/virtuejs//static/sh_main.js"></script>
<script type="text/javascript" src="http://localhost/virtuejs//static/sh_javascript.js"></script>

<!--[if lte IE 8]>
<script type="text/javascript" src="http://localhost/virtuejs//static/html5.js"></script>
<![endif]-->

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,600&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../../static/jsdoc.css" />
<link rel="stylesheet" href="../../static/style.css" />
<script type="text/javascript" src="../../static/jquery.min.js"></script>
<script type="text/javascript" src="../../static/jsdoc.js"></script>

</head>

<body onload="sh_highlightDocument()" lang="en">

  <header>
    <nav class="navigation">
      <h1><a href="http://localhost/virtuejs/"><img src="http://localhost/virtuejs//static/virtuejs-logo.png" alt="VirtueJs" title="Home" /></a></h1>
      <ul>
        <li><a href="http://localhost/virtuejs//get_started.html">Get Started</a></li>
        <li><a href="http://localhost/virtuejs//reinhardt.html">The template layer</a></li>
        <li><a href="http://localhost/virtuejs//sqlstore.html">The model layer</a></li>
        <li><a href="http://localhost/virtuejs//stick.html">The view layer</a></li>
      </ul>
    </nav>
    <div style="clear: both;"></div>
  </header>

  <main class="main">

    <div class="content">
      
            <h1 class="modulename">Module stick/middleware/continuation</h1>
        <div class="fileoverview">
            <p>Provide support for JavaScript 1.7 generator actions. </p>

<p>This middleware supports two types of yield values from generators: 
Promises and JSGI response objects.</p>

<p>If a generator action yields a promise, this middleware adds a listener to that
promise that will feed the value back to the generator once the promise is resolved.
If the promise resolves to an error, the error is thrown in the generator.</p>

<p>For example, if <code>promise</code> is a promise, the <code>yield</code> statement will interrupt execution
of the action until the promise is resolved, at which point the generator is resumed
with the value of the promise being assigned to the <code>resolved</code> variable.</p>

<pre><code>var resolved = yield promise;</code></pre>

<p>If a generator action yields a JSGI response, the response is sent to the client.
To be able to yield more than one response from the same generator, the generator
has to be associated with a continuation id and stored in the user's session.
This is done by calling <code>continuation.activate()</code> before yielding the first
response. The <code>activate()</code> method tells the middleware to store the generator
in the user's session and returns a contination id.</p>

<p>For subsequent invocations of the generator, the continuation id has to be set as
query string parameter with name <code>_c</code>. When suspended generator is resumed,
the new request object is passed in as value for the last yield statement.</p>

<pre><code>function continuation(request) {
    var c = app.continuation.activate();
    while(true) {
        request = yield response.html(linkTo(app, {_c: c}));
    }
}</code></pre>


<p>See <a href="http://blog.ometer.com/2010/11/28/a-sequential-actor-like-api-for-server-side-javascript/">http://blog.ometer.com/2010/11/28/a-sequential-actor-like-api-for-server-side-javascript/</a>
for background.</p>


        </div>

        <div class="classoverview">

            </div>
    
    </div>

    <div class="submenu">
      <div class="wrapper">
        <!-- <div class="jsdocSidenav">
   <div class="toggles">
      <a href="../../">&bull; Modules</a>
      <a href="../../index_all.html">&bull; Overview</a>
   </div>

   <input id="filter" type="text" placeholder="Filter modules" />

   <ul id="modulelist">
            <li><a href="../../stick/">stick</a></li>
            <li><a href="../../helpers/">stick/helpers</a></li>
            <li><a href="../../middleware/">stick/middleware</a></li>
            <li><a href="../../middleware/basicauth/">stick/middleware/basicauth</a></li>
            <li><a href="../../middleware/continuation/">stick/middleware/continuation</a></li>
            <li><a href="../../middleware/cookies/">stick/middleware/cookies</a></li>
            <li><a href="../../middleware/error/">stick/middleware/error</a></li>
            <li><a href="../../middleware/etag/">stick/middleware/etag</a></li>
            <li><a href="../../middleware/gzip/">stick/middleware/gzip</a></li>
            <li><a href="../../middleware/method/">stick/middleware/method</a></li>
            <li><a href="../../middleware/mount/">stick/middleware/mount</a></li>
            <li><a href="../../middleware/notfound/">stick/middleware/notfound</a></li>
            <li><a href="../../middleware/params/">stick/middleware/params</a></li>
            <li><a href="../../middleware/profiler/">stick/middleware/profiler</a></li>
            <li><a href="../../middleware/render/">stick/middleware/render</a></li>
            <li><a href="../../middleware/requestlog/">stick/middleware/requestlog</a></li>
            <li><a href="../../middleware/route/">stick/middleware/route</a></li>
            <li><a href="../../middleware/session/">stick/middleware/session</a></li>
            <li><a href="../../middleware/static/">stick/middleware/static</a></li>
            <li><a href="../../middleware/upload/">stick/middleware/upload</a></li>
      </ul>
</div>
 -->
      </div>
    </div>

  </main>

  <footer>
    <nav class="ringolinks">
      <ul>
        <li><h4>Templates</h4></li>
        <li><a href="http://localhost/virtuejs//reinhardt/templates.html">Syntax overview</a></li>
        <li><a href="http://localhost/virtuejs//reinhardt/filters.html">Filter reference</a></li>
        <li><a href="http://localhost/virtuejs//reinhardt/tags.html">Tag reference</a></li>
      </ul>

      <ul>
        <li><h4>Models</h4></li>
        <li><a href="http://localhost/virtuejs//sqlstore/Basics.html">Connecting to the database</a></li>
        <li><a href="http://localhost/virtuejs//sqlstore/Mapping.html">Model mapping</a></li>
        <li><a href="http://localhost/virtuejs//sqlstore/Query.html">Querying</a></li>
      </ul>

      <ul>
        <li><h4>View</h4></li>
        <li><a href="http://localhost/virtuejs//stick/route.html">Routing definitions</a></li>
      </ul>
      <ul>
        <li><h4>Other</h4></li>
        <li><a href="http://localhost/virtuejs//deployment.html">Deployment</a></li>
      </ul>
    </nav>
  </footer>

</body>
</html>
